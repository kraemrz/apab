<!DOCTYPE html>
<html lang="sv">
<head>
  <meta name="theme-color" content="#f0c040">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <meta charset="UTF-8" />
  <title>Inspektionsprotokoll</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- === TOP-CONTROLLER === -->
<div class="controls">
  <div class="left">
    <form id="uploadForm">
      <div id="drop-zone">
        ğŸŸ¢ SlÃ¤pp en .docx eller .json-fil hÃ¤r eller klicka fÃ¶r att vÃ¤lja
        <input type="file" id="fileInput" name="file" accept=".docx,.json" hidden>
      </div>
    </form>
  </div>

  <div class="right" id="exportControls" style="display: none;">
    <!-- Export-formulÃ¤r -->
    <form id="exportForm" method="POST" action="/export-word">
      <input type="hidden" name="html" id="htmlInput" />
      <input type="hidden" name="inspection_date" id="inspectionDateInput">
      <input type="hidden" name="lang" id="langInput">
      <input type="hidden" name="customer" id="customerInput">
      <input type="hidden" name="machine" id="machineInput">
      <input type="hidden" name="comments_json" id="commentsInput">
      <input type="hidden" name="signature" id="signatureInput">
      <button type="submit" id="saveWordSubmitButton">ğŸ’¾ Spara Word</button>
    </form>
    <!-- Knapparna Ã¤r nu samlade -->
    <button type="button" id="saveTempDocxButton">ğŸ’¾ Spara tillfÃ¤lligt</button>
    <button id="history-toggle-button">ğŸ“œ Visa historik</button>
    <button onclick="toggleDark()">ğŸŒ™ MÃ¶rkt lÃ¤ge</button>
  </div>
</div>

<div class="container">
  <div id="result">ğŸ“ Ladda upp ett dokument...</div>
</div>

  <!-- NY KOD: Plats fÃ¶r varning om icke-Chromium webblÃ¤sare -->
  <div id="browserWarning" style="display: none; background-color: #ffc107; color: #343a40; padding: 8px 15px; border-radius: 5px; margin-top: 10px; text-align: center; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    âš  FÃ¶r bÃ¤sta upplevelse och full funktionalitet (inklusive autosparning) rekommenderas Google Chrome eller Microsoft Edge.
  </div>
</div>

<!-- ... din befintliga script.js laddning ... -->
<script>
    // --- NY KOD: Detektera Chromium webblÃ¤sare ---
    function isChromium() {
        // Kontrollerar om 'window.chrome' objektet finns och om det finns en 'vendor' property som innehÃ¥ller 'Google Inc.'
        // Detta Ã¤r ett ganska robust sÃ¤tt att detektera Chromium-baserade webblÃ¤sare.
        return (!!window.chrome && (navigator.vendor === 'Google Inc.'));
    }

    // NÃ¤r DOM Ã¤r laddad, kÃ¶r kontrollen
    document.addEventListener('DOMContentLoaded', function() {
        const browserWarningElement = document.getElementById('browserWarning');
        const saveTempDocxButton = document.getElementById('saveTempDocxButton'); // MÃ¥ste hÃ¤mta referensen hÃ¤r ocksÃ¥

        if (browserWarningElement && !isChromium()) {
            browserWarningElement.style.display = 'block'; // Visa varningen
            
            // Valfritt: Inaktivera "Spara tillfÃ¤lligt" om det inte Ã¤r Chromium
            if (saveTempDocxButton) {
                saveTempDocxButton.disabled = true;
                saveTempDocxButton.style.opacity = '0.5';
                saveTempDocxButton.style.cursor = 'not-allowed';
                saveTempDocxButton.title = "KrÃ¤ver Chrome/Edge fÃ¶r full autosave-funktionalitet.";
            }
        }
    });
</script>

<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>